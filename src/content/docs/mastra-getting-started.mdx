---
title: "简介 | Mastra 文档"
description: "Mastra 是一个 TypeScript 智能体框架，帮助你快速构建 AI 应用与功能。它提供你所需的原子能力：工作流、智能体、RAG、集成、同步与评估。"
sidebar_order: 1
category: "Mastra"
---


# 安装 Mastra

开始使用 Mastra 之前，你需要先获得一个大语言模型（LLM）的访问权限。  
默认情况下，Mastra 已配置为使用 OpenAI，因此你需要准备一支 OpenAI API Key。

Mastra 同时支持其他 LLM 提供商。完整的支持模型与配置方式请参考「模型提供商」章节。

## 前置条件

- Node.js ≥ v20.0  
- 已注册任一受支持模型提供商的 API Key  

## 使用 create-mastra CLI 安装（推荐）

CLI 是最快捷的入门方式，可在任意目录执行。

> 当前 CLI 生成的项目仅兼容 ai-sdk v4。如需使用 ai-sdk v5，请阅读文末「ai-sdk v5 兼容性」说明。

### 1. 启动交互式向导

```bash
npx create-mastra@latest
```

### 2. 非交互式安装（带参数）

一次性传入全部参数即可跳过交互：

```bash
npx create-mastra@latest \
  --project-name hello-mastra \
  --example \
  --components tools,agents,workflows \
  --llm openai
```

### 3. 使用模板

通过官方模板快速体验典型场景：

```bash
npx create-mastra@latest --template <模板名称>
```

查看可用模板与更多说明请访问「Templates」页面。  
例如，创建一个 Text-to-SQL 应用：

```bash
npx create-mastra@latest --template text-to-sql
```

完整 CLI 参数列表见 `create-mastra` 文档。

### 4. 填写 API Key

在项目根目录的 `.env` 文件中加入：

```env
OPENAI_API_KEY=<你的密钥>
```

> 示例以 OpenAI 为例。不同提供商的环境变量名可能不同，详见「Model Capabilities」。

### 5. 启动本地开发服务器

```bash
npm run dev
```

浏览器将自动打开 Mastra Playground，可实时测试智能体。

---

## 手动安装

如需完全掌控依赖与目录结构，可按以下步骤手动搭建。

### 1. 创建项目并安装依赖

```bash
mkdir hello-mastra && cd hello-mastra
npm init -y

# 开发依赖
npm install -D typescript tsx @types/node mastra@latest

# 运行依赖
npm install @mastra/core@latest zod@^3 @ai-sdk/openai@^1
```

在 `package.json` 中添加脚本：

```json
{
  "scripts": {
    "dev": "mastra dev",
    "build": "mastra build"
  }
}
```

### 2. 初始化 TypeScript

新建 `tsconfig.json` 并写入：

```json
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "ES2022",
    "moduleResolution": "bundler",
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "strict": true,
    "skipLibCheck": true,
    "noEmit": true,
    "outDir": "dist"
  },
  "include": ["src/**/*"]
}
```

> Mastra 要求 `module` 与 `moduleResolution` 采用现代 Node.js 方案，旧版 CommonJS 会导致解析错误。

### 3. 配置 API Key

```bash
touch .env
```

```env
OPENAI_API_KEY=<你的密钥>
```

### 4. 创建工具（Tool）

```bash
mkdir -p src/mastra/tools
touch src/mastra/tools/weather-tool.ts
```

```ts
// src/mastra/tools/weather-tool.ts
import { createTool } from "@mastra/core/tools";
import { z } from "zod";

export const weatherTool = createTool({
  id: "get-weather",
  description: "获取指定城市的当前天气",
  inputSchema: z.object({
    location: z.string().describe("城市名称")
  }),
  outputSchema: z.object({
    output: z.string()
  }),
  execute: async () => ({
    output: "天气晴朗"
  })
});
```

完整示例参考「为智能体添加工具」章节。

### 5. 创建智能体（Agent）

```bash
mkdir -p src/mastra/agents
touch src/mastra/agents/weather-agent.ts
```

```ts
// src/mastra/agents/weather-agent.ts
import { openai } from "@ai-sdk/openai";
import { Agent } from "@mastra/core/agent";
import { weatherTool } from "../tools/weather-tool";

export const weatherAgent = new Agent({
  name: "Weather Agent",
  instructions: `
你是一位天气助手，负责提供准确的天气信息。

- 若用户未提供地点，请主动询问；
- 若地点非英文，请翻译为英文；
- 对于复合地点（如“New York, NY”），仅使用最相关的部分；
- 返回包含湿度、风速与降水情况的简洁信息；
- 务必使用 weatherTool 获取数据。
  `,
  model: openai("gpt-4o-mini"),
  tools: { weatherTool }
});
```

### 6. 注册智能体

```bash
touch src/mastra/index.ts
```

```ts
// src/mastra/index.ts
import { Mastra } from "@mastra/core/mastra";
import { weatherAgent } from "./agents/weather-agent";

export const mastra = new Mastra({
  agents: { weatherAgent }
});
```

完成！执行 `npm run dev` 即可在 Mastra Playground 中测试。

---

## 在现有项目中集成

Mastra 可无缝接入多种主流框架，已提供专项指南：

- [Next.js 集成](/docs/integration/nextjs)  
- [Vite + React 集成](/docs/integration/vite-react)  
- [Astro 集成](/docs/integration/astro)  
- [Express 集成](/docs/integration/express)  

也可直接在旧项目执行：

```bash
npx mastra init
```

详见 `mastra init` 命令文档。

---

## ai-sdk v5 兼容性

默认生成的项目锁定 ai-sdk v4。如需升级至 v5，请执行：

```bash
npm install @ai-sdk/openai@latest
```

并将工作流中的调用方式从：

```ts
const response = await agent.stream([{ role: 'user', content: prompt }]);
```

改为：

```ts
const response = await agent.streamVNext([{ role: 'user', content: prompt }]);
```

---

## 下一步

- [本地开发技巧](/docs/getting-started/local-dev)  
- [部署到 Mastra Cloud](/docs/deployment/mastra-cloud)